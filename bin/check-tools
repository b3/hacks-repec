#!/bin/sh
# Vérifie que tous les outils nécessaires sont disponibles.
#
# usage: check-tools [OPTIONS]
#
# OPTIONS possibles :
#     -h, --help  affiche ce message
#     -l          liste les outils nécessaires

usage () { sed -n '2,/^$/ {s/^ *#// ; s/^ //g ; p }' <$0 ; }
missing () { echo "$1 is unavailable" ; exit 1 ; }
mute () { 1>/dev/null 2>&1 $* ; }

[ "x$1" = "x-h" -o "x$1" = "x--help" ] && usage && exit
[ "$1" = "-l" ] && egrep '\|\| missing' $0 | sed -r 's/^.* (.*)$/\1/' && exit

# Pour le lancement des tâches
mute which make || missing make

# Pour la récupération des archives
mute which wget || missing wget

# Pour la gestion des versions
mute which git || missing git

# Pour la conversion Markdown vers beamer
mute which pandoc || missing pandoc
mute which base64 || missing base64
mute which pdflatex || missing pdflatex texlive
mute kpsewhich beamer.cl || missing beamer.cls texlive-latex-recommended
