#!/bin/bash
# Récupère l'intégralité de l'archive all de RePEc en local.
# 
# usage: get-archive-all [OPTIONS] [DEST]
#
# L'archive est copiée dans DEST/remo/all.
#
# Par défaut DEST=/home/repec/RePEc.
# 
# OPTIONS possibles :
#     -h, --help  affiche ce message

usage () { sed -n '2,/^$/ {s/^ *#// ; s/^ //g ; p }' <$0 ; }
[ "x$1" = "x-h" -o "x$1" = "x--help" ] && usage && exit

set -e
umask 0002

DEST="${1:-/home/repec/RePEc}"

cd "$DEST/remo" && mkdir -p all ../log && cd all &&
(
    exec 2>&1 ; set -x
    wget -r -l inf -nH --cut-dirs=2 -nc "ftp://all.repec.org/RePEc/all"
) | tee -a $DEST/log/$(basename $0).log
